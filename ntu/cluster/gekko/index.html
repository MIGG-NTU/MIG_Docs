<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gekko &mdash; MIG Documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" />
    <link rel="next" title="Fugaku" href="../fugaku/" />
    <link rel="prev" title="Clusters for MIGG members" href="../" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../" class="icon icon-home"> MIG Documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../">Resources at NTU</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../dr-ntu/">Research Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vpn/">VPN</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../">Clusters for MIGG members</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Gekko</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#account">Account</a></li>
<li class="toctree-l4"><a class="reference internal" href="#project-group">Project Group</a></li>
<li class="toctree-l4"><a class="reference internal" href="#manual">Manual</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../fugaku/">Fugaku</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../spms-network/">Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../printer/">Printers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../eos-poster/">Printing Posters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../room-booking/">Booking LT/TR Room</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../two-factor-authentication/">Workday Two-Factor Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../overseas-travel-policy/">Overseas business travel policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../flight-BTS/">Flight Ticket &amp; Business Travel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ntu-blog/">Groupmeeting Website Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ntu-ecampus/">NTU eCampus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../leaders-executives/">NTU Leaders and Executives</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../singapore/">Living in Singapore</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Research</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../group-meeting/">Group Meeting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../seismology/">Learning Seismology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../programming/">Learning Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../geosciences/">Learning Geosciences</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data-archive/">Data at MIG</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../links/">Links</a></li>
</ul>


    
        <p class="caption">
            <span class="caption-text">Getting help</span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://personal.ntu.edu.sg/tongping/"><i class="fa fa-home"></i> MIG Homopage</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/MIGG-NTU/MIG_Docs"><i class="fa fa-github fa-fw"></i> Source Code</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/MIGG-NTU/MIG_Docs/discussions"><i class="fa fa-comments fa-fw"></i> Contact</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../">MIG Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../">Resources at NTU</a> &raquo;</li>
          <li><a href="../">Clusters for MIGG members</a> &raquo;</li>
      <li>Gekko</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/MIGG-NTU/MIG_Docs/blob/main/source/ntu/cluster/gekko.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="gekko">
<h1>Gekko<a class="headerlink" href="#gekko" title="Permalink to this headline"></a></h1>
<dl class="field-list simple">
<dt class="field-odd">contributors</dt>
<dd class="field-odd"><p><a class="reference external" href="https://github.com/core-man">Yao Jiayuan</a></p>
</dd>
<dt class="field-even">last updating date</dt>
<dd class="field-even"><p>2021-05-22</p>
</dd>
</dl>
<hr class="docutils" />
<p>We usually use a cluter called GEKKO. Its address is <strong>gekko.earthobservatory.sg</strong> or <strong>gekko.hpc.ntu.edu.sg</strong>,
both of which are the same. GEKKO is owned by EOS, while it is now maintained by NTU HPC.
It is free for EOS users, while it will be charged for other users at NTU.</p>
<section id="account">
<h2>Account<a class="headerlink" href="#account" title="Permalink to this headline"></a></h2>
<p>We need to apply for an account before we can use GEKKO. Please ask Tong Ping for help.
If the NTU network account is jiayuanyao, then we could use <code class="docutils literal notranslate"><span class="pre">ssh</span></code> to log in Gekko:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ssh jiayuanyao@gekko.earthobservatory.sg
</pre></div>
</div>
<p>It is recommended to use VS Code to log in Gekko and work on codes and files.
Please refer to a <a class="reference external" href="https://seismo-learn.org/seismology101/computer/editor/#vs-code">VS Code tutorial</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When you get a account, you should test if you can run a task.
Sometimes your account may not be set up, and you cannot submit a task
(an error <code class="docutils literal notranslate"><span class="pre">qsub:</span> <span class="pre">Unauthorized</span> <span class="pre">Request</span></code> may appear).
Please use the following example to test.</p>
</div>
</section>
<section id="project-group">
<h2>Project Group<a class="headerlink" href="#project-group" title="Permalink to this headline"></a></h2>
<p>PBS-Pro requires a project group to function. Prof Tong Ping has two project groups:</p>
<ul class="simple">
<li><p><strong>spms_tongping</strong>: 4 cents per core hour</p></li>
<li><p><strong>eos_tongping</strong>: free and no charge since EOS has already paid for the resources.
It can be used for running collaboration jobs with EOS</p></li>
</ul>
</section>
<section id="manual">
<h2>Manual<a class="headerlink" href="#manual" title="Permalink to this headline"></a></h2>
<section id="general-guide">
<h3>General guide<a class="headerlink" href="#general-guide" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://entuedu.sharepoint.com/teams/ntuhpcusersgroup2">NTU-HPC</a>: you can find a lot of manuals here.
Please read <code class="file docutils literal notranslate"><span class="pre">Quick</span> <span class="pre">User</span> <span class="pre">Guide</span> <span class="pre">for</span> <span class="pre">Gekko</span></code> to learn some basic usage of GEKKO.</p></li>
<li><p><a class="reference external" href="https://www.yammer.com/e.ntu.edu.sg/#/threads/inGroup?type=in_group&amp;feedId=15849979904&amp;view=all">NTU-HPC Yammer Users’ Group Site</a>:
you can also download from the App Store/Google Play/Microsoft Office Site.
Do log in with your NTU-ID. The Yammer Group is called “NTU HPC Users’ Group”</p></li>
<li><p><a class="reference external" href="https://ts.ntu.edu.sg/sites/hpc/_layouts/15/start.aspx#/User%20Guide/Forms/AllItems.aspx?RootFolder=%2Fsites%2Fhpc%2FUser%20Guide%2Fgekko%2Dcluster&amp;FolderCTID=0x012000B75E77F6895B184182BB95924F3CE8F3&amp;View=%7BFDF6D033%2DDC8E%2D459B%2DAE2E%2DEE8C1DD67F06%7D">GEKKO User Guide</a></p></li>
</ul>
</section>
<section id="using-cpu">
<h3>Using CPU<a class="headerlink" href="#using-cpu" title="Permalink to this headline"></a></h3>
<p>Please copy the script file from <code class="file docutils literal notranslate"><span class="pre">/usr/local/templates</span></code> (e.g., <code class="file docutils literal notranslate"><span class="pre">mpi.pbs</span></code> or <code class="file docutils literal notranslate"><span class="pre">matlab.pbs`</span></code>)
to your working folder. Then you could edit it based on your task, e.g.,:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#PBS</span> <span class="pre">-P</span> <span class="pre">eee_userid</span></code> –&gt;&gt; <code class="docutils literal notranslate"><span class="pre">#PBS</span> <span class="pre">-P</span> <span class="pre">eos_tongping</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#PBS</span> <span class="pre">-q</span> <span class="pre">q32</span></code> –&gt;&gt; <code class="docutils literal notranslate"><span class="pre">#PBS</span> <span class="pre">-q</span> <span class="pre">q32_eos</span></code></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please see <a class="reference external" href="https://entuedu.sharepoint.com/teams/ntuhpcusersgroup2/SitePages/Queue-Information-and-Pricing.aspx">Queue Information Pricing</a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">q32</span></code> allows max of 512 cores per user.
<code class="docutils literal notranslate"><span class="pre">q32_eos</span></code> is specially for eos user where you can run 1024 cores.
However, it seems that there are between those two queues no difference at all now.</p>
<p>A new queue &#64;Gekko called <code class="docutils literal notranslate"><span class="pre">budget_night</span></code> which is 50% cheaper.
The catch is that the job will only run from 6 pm onwards and it has 12 hours wall-time limits only.
But there is no restriction in the number of cores you can use.
For more information do get it from Yammer (NTU HPC Users’ Group) or NTU-HPC website.</p>
</div>
<p>Run the script to submit a task:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">qsub</span> <span class="n">mpi</span><span class="o">.</span><span class="n">pbs</span> <span class="o">-</span><span class="n">v</span> <span class="n">inputfile</span><span class="o">=</span><span class="n">your_binary_script</span>
</pre></div>
</div>
</section>
<section id="using-gpu">
<h3>Using GPU<a class="headerlink" href="#using-gpu" title="Permalink to this headline"></a></h3>
<p>GEKKO also has 8 GPU. The GPU resources consist of 2 GPU servers with 8 GPU cards each.
You can access it through the queue <code class="docutils literal notranslate"><span class="pre">gpu8</span></code>. The template GPU submission script is available at <code class="file docutils literal notranslate"><span class="pre">/usr/local/templates/gpu/gpu.pbs</span></code>.
You can change the variable of <em>ngpus</em> in the submission scripts to request for the number of GPU cards you required.
The system will allocate the GPU cards to you when the job runs.
For each GPU card requests, 4 CPU cores will be allocated automatically by the system.
Thus the variable in the <em>ncpus</em> will be overwritten by the system.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># require GPU
$ qsub -l select=1:ncpus=32:ngpus=1 -P eos_tongping -q gpu8 -I

# check GPU details
$ nvidia-smi

# load cuda/10.1. You can write it in ~/.bashrc
$ module load cuda/10.1
</pre></div>
</div>
</section>
<section id="use-python">
<h3>Use Python<a class="headerlink" href="#use-python" title="Permalink to this headline"></a></h3>
<p>Edwin has installed Anaconda on Gekko, and he suggested us use Anaconda to create virtual environment
where we can run python packages with better version control. Version control usually is important for python.
See <a class="reference external" href="https://seismo-learn.org/software/anaconda/#id2">seismo-learn/software/anaconda</a> for a brief tutorial.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># 1. Create virtual environment (e.g., myvirtual)
$ conda create --name myvirtual

# 2. Activate virtual environment
$ conda activate myvirtual

# 3. Install packages in the virtual environment via either conda or pip
$ conda install matplotlib
$ pip install matplotlib
</pre></div>
</div>
</section>
<section id="using-scratch-space">
<h3>Using Scratch Space<a class="headerlink" href="#using-scratch-space" title="Permalink to this headline"></a></h3>
<p><strong>An initial notice sent to Jiayuan Yao</strong></p>
<p>If you are hoping to speed up your work especially if you have reading/writing lots of data (I/O intensive),
you may want to use <code class="docutils literal notranslate"><span class="pre">/scratch/username</span></code>. The scratch space is a fast scratch space several time faster than home directory.
It was meant to speed up computing run (nearly <strong>3 times faster</strong>).
So you will recover back your time. But you have to clear off the data manually after the run as the scratch space is very expensive and limited.</p>
<p><strong>An notice posted in Yammer on Dec. 14 2020</strong> (<a class="reference external" href="https://www.yammer.com/e.ntu.edu.sg/#/threads/show?threadId=989272424267776">link</a>)</p>
<p>NVMe Scratch Space has been increased from <strong>50TB</strong> to <strong>150TB</strong>. Speed up your work by using this fast scratch space!</p>
<p>We have upgraded the NVMe Scratch so that you can have the lowest latency and highest performance especially when your Read/Write to the disk is high.</p>
<p>Every users should have a scratch space called <code class="docutils literal notranslate"><span class="pre">/scratch/youruserid</span></code>.
You can copy the specific folder (not your entire home directory please) that you are running there and submit your jobs via <code class="docutils literal notranslate"><span class="pre">qsub</span></code>.
<strong>Upon completion of the job, copy the essential files or folder back to your home directory</strong>.</p>
<p>Do note that the scratch directory is not a home directory to store data permanently. It is a super-fast read/write space</p>
<p>If you are not sure how to use it drop me an private email via yammer.</p>
</section>
<section id="notes">
<h3>Notes<a class="headerlink" href="#notes" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Module</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># check all options of module
$ module
</pre></div>
</div>
<p>We could set up some packages in the setting file, e.g., <code class="file docutils literal notranslate"><span class="pre">~/.bashrc</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load intel</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">intel</span><span class="o">/</span><span class="mi">2018</span><span class="n">u3</span>

<span class="c1"># Load MATLAB</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">matlab</span><span class="o">/</span><span class="n">R2019b</span>

<span class="c1"># Load CUDA</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">cuda</span><span class="o">/</span><span class="mf">10.1</span>
</pre></div>
</div>
</section>
<section id="quota">
<h3>Quota<a class="headerlink" href="#quota" title="Permalink to this headline"></a></h3>
<p>Each node has a memory of 384 GB. Default disk quota is 500 GB for an EOS user.
If you need more (e.g., 10 TB), please drop a mail to Edwin Tan Seng Tat (<a class="reference external" href="mailto:EdwinTan&#37;&#52;&#48;ntu&#46;edu&#46;sg">EdwinTan<span>&#64;</span>ntu<span>&#46;</span>edu<span>&#46;</span>sg</a>).
Default disk quota is 200 GB for other user, and please see the <a class="reference external" href="https://ts.ntu.edu.sg/sites/hpc/_layouts/15/start.aspx#/Charges">website</a> for additional space.</p>
<p>Software and Hardware Inventories:
<a class="reference external" href="https://ts.ntu.edu.sg/sites/hpc/_layouts/15/start.aspx#/Hardware%20Configuration">Hardware Inventories</a> |
<a class="reference external" href="https://ts.ntu.edu.sg/sites/hpc/_layouts/15/start.aspx#/Software%20Inventory">Software Inventories</a></p>
<p>If you have any query, feel free to drop a mail to Edwin Tan Seng Tat (<a class="reference external" href="mailto:EdwinTan&#37;&#52;&#48;ntu&#46;edu&#46;sg">EdwinTan<span>&#64;</span>ntu<span>&#46;</span>edu<span>&#46;</span>sg</a>) at EOS, or <a class="reference external" href="mailto:hpcsupport&#37;&#52;&#48;ntu&#46;edu&#46;sg">hpcsupport<span>&#64;</span>ntu<span>&#46;</span>edu<span>&#46;</span>sg</a></p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../" class="btn btn-neutral float-left" title="Clusters for MIGG members" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../fugaku/" class="btn btn-neutral float-right" title="Fugaku" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020–2022, MIGG-NTU.
      <span class="lastupdated">Last updated on 2022-04-08.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>